工作场景：
你是一名非常优秀的计算机工程师，注重代码的简洁性和可维护性，熟练使用聚宽API进行量化交易及回测
同时你的代码当中很少有bug存在。此外，你在任务开始时，习惯性添加一句print（'任务已经开始'），以方便测试

工作任务:
1.在聚宽平台上获取所有股票日k的换手率数据；
聚宽API：
https://www.joinquant.com/help/api/help#name:api

参考资料:
import pandas as pd
from pymongo import MongoClient
import datetime
client = MongoClient(
    "mongodb://wth000:wth000@43.159.47.250:27017/dbname?authSource=wth000")
db = client["wth000"]
name = ("000", "001", "002", "600", "601", "603", "605")

# collection = db[f"聚宽ST股票{name}"]
# end_date= datetime.date(2018, 1, 1)
# start_date = datetime.date.today()  # 结束日期为今天
# delta = datetime.timedelta(days=1)  # 时间间隔为一天
# date = start_date
# dates = collection.distinct("日期")
# print("已收录日期数据",dates)
# collection.drop()
# while date >= end_date:
#     date -= delta
#     df = get_all_securities(types=['stock'], date=date)
#     df = df[df['display_name'].str.contains("S")|df["display_name"].str.contains("退")]
#     df = df[df.index.str.startswith(name)].copy()
#     df.rename_axis('代码', inplace=True)
#     df.reset_index(inplace=True)
#     df['代码'] = df['代码'].str.extract('(\d+)').astype(float)
#     today = datetime.datetime.combine(date, datetime.datetime.min.time()).strftime('%Y-%m-%d')
#     df['日期']=today
#     df=df[['日期','代码']]
#     if today not in dates:
#         collection.insert_many(df.to_dict("records"))
#         print(df)
#     df = pd.DataFrame()
# print("获取ST股票完毕")

# collection = db[f"聚宽非ST股票{name}"]
# end_date= datetime.date(2018, 1, 1)
# start_date = datetime.date.today()  # 结束日期为今天
# delta = datetime.timedelta(days=1)  # 时间间隔为一天
# date = start_date
# dates = collection.distinct("日期")
# collection.drop()
# print("已收录日期数据",dates)
# while date >= end_date:
#     date -= delta
#     df = get_all_securities(types=['stock'], date=date)
#     df = df[~df['display_name'].str.contains("S")]
#     df = df[~df['display_name'].str.contains("退")]
#     df = df[df.index.str.startswith(name)].copy()
#     df.rename_axis('代码', inplace=True)
#     df.reset_index(inplace=True)
#     df['代码'] = df['代码'].str.extract('(\d+)').astype(float)    
#     today = datetime.datetime.combine(date, datetime.datetime.min.time()).strftime('%Y-%m-%d')
#     df['日期']=today
#     df=df[['日期','代码']]
#     if today not in dates:
#         collection.insert_many(df.to_dict("records"))
#         print(df)
#     df = pd.DataFrame()
# print("获取非ST股票完毕")

# collection = db[f"聚宽基本面股票{name}"]
# end_date= datetime.date(2018, 1, 1)
# start_date = datetime.date.today()  # 结束日期为今天
# delta = datetime.timedelta(days=1)  # 时间间隔为一天
# date = start_date
# dates = collection.distinct("日期")
# collection.drop()
# print("已收录日期数据",dates)
# while date >= end_date:
#     date -= delta
#     df = get_fundamentals(query(
#         valuation.code, valuation.market_cap, valuation.pe_ratio, income.total_operating_revenue
#     ), date=date)
#     df = df.rename(columns={"code": "代码", "total_operating_revenue": "营收","market_cap":"总市值","pe_ratio":"市盈率"})
#     df = df[df["代码"].str.startswith(name)]
#     df['代码'] = df['代码'].str.extract('(\d+)').astype(float)
#     today = datetime.datetime.combine(date, datetime.datetime.min.time()).strftime('%Y-%m-%d')
#     df['日期']=today
#     if today not in dates:
#         collection.insert_many(df.to_dict("records"))
#         print(df)
# print("获取基本面数据完毕")
collection=db[f"聚宽可转债"]
codes=get_all_securities(types=['conbond'])
codes.rename_axis("代码", inplace=True)
codes.reset_index(inplace=True)
start_date= datetime.date(2018, 1, 1)
end_date = datetime.date.today()
collection.drop()
print(codes)
for code in codes["代码"]:
    print(code)
    df=get_price(code)
    df['代码']=code
    df['代码'] = df['代码'].str.extract('(\d+)').astype(float)
    print(df)
    collection.insert_many(df.to_dict("records"))
